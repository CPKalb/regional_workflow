MACHINE="hera"
ACCOUNT="rtrr"
#EXPT_SUBDIR="time_lag.20210508.automated"

COMPILER="intel"
VERBOSE="TRUE"

RUN_ENVIR="community"
PREEXISTING_DIR_METHOD="rename"

POST_OUTPUT_DOMAIN_NAME="RRFS_CONUS_25km"

#USE_CRON_TO_RELAUNCH="TRUE"
USE_CRON_TO_RELAUNCH="FALSE"
CRON_RELAUNCH_INTVL_MNTS="01"

FCST_LEN_HRS="6"

DATE_FIRST_CYCL="20210508"
#DATE_LAST_CYCL="20210506"
DATE_LAST_CYCL="20210508"
CYCL_HRS=( "00" )

#DATE_FIRST_CYCL="20210507"
#DATE_LAST_CYCL="20210507"
#CYCL_HRS=( "12" )

WTIME_VX_ENSPOINT="08:00:00"
WTIME_VX_ENSGRID="08:00:00"

NET='RRFSE_CONUS'

DO_ENS_FCST="TRUE"
#NUM_ENS_MEMBERS="9"
NUM_ENS_MEMBERS="2"
#NUM_ENS_MEMBERS="3"
#ENS_TIME_LAG_HRS=( "0" "12")

EXPT_SUBDIR="_lag.cdates_${DATE_FIRST_CYCL}-${DATE_LAST_CYCL}.num_ens_mems_$(printf "%02d" "${NUM_ENS_MEMBERS}").fcst_len_$(printf "%02d" "${FCST_LEN_HRS}")h"

if [ 0 = 1 ]; then
  ENS_TIME_LAG_HRS=( "0" "0" )
#  EXPT_SUBDIR="no${EXPT_SUBDIR}"
#  EXPT_SUBDIR="test_xml_single_init"
  EXPT_SUBDIR="test_pcpcombine_single_init"
  EXPT_SUBDIR="test_gridstat_nopcpcombine_single_init"
  EXPT_SUBDIR="test_single_init"
  EXPT_SUBDIR="test_single_init_cleanup"
else
#  ENS_TIME_LAG_HRS=( "0" "12" "12" )
  ENS_TIME_LAG_HRS=( "0" "12" )
#  EXPT_SUBDIR="with${EXPT_SUBDIR}"
#  EXPT_SUBDIR="test_xml_time_lagged"
#  EXPT_SUBDIR="test_pcpcombine_time_lagged"
#  EXPT_SUBDIR="test_xml_APCP_loop_time_lagged"
#  EXPT_SUBDIR="test_gridstat_nopcpcombine_time_lagged"
#  EXPT_SUBDIR="test_gepes_cmn_time_lagged"
#  EXPT_SUBDIR="test_pb2nc_time_lagged"
#  EXPT_SUBDIR="test_mean_time_lagged"
#  EXPT_SUBDIR="test_split_old_new_vx_time_lagged"
#  EXPT_SUBDIR="test_missing_obs_time_lagged"
  EXPT_SUBDIR="test_time_lagged"
  EXPT_SUBDIR="test_time_lagged_cleanup"
  EXPT_SUBDIR="test_time_lagged_obs_templates"
  EXPT_SUBDIR="test_time_lagged_fcst_obs_templates"
fi

#MODEL="FV3_RRFSE_${EXPT_SUBDIR}"
MODEL="FV3_RRFSE"
METPLUS_PATH="/contrib/METplus/METplus-4.1.1"
#METPLUS_PATH="/scratch2/BMC/det/Gerard.Ketefian/UFS_CAM/METplus/METplus-4.1.1"
MET_INSTALL_DIR="/contrib/met/10.1.1"
#MET_INSTALL_DIR="/scratch2/BMC/det/Gerard.Ketefian/UFS_CAM/met/10.1.1"
MET_INPUT_DIR="/scratch1/BMC/hmtb/beck/ens_design_RRFS/data"
#MET_OUTPUT_DIR="/scratch2/BMC/fv3lam/ens_design_RRFS/single_init"
#CCPA_OBS_DIR="/scratch2/BMC/fv3lam/ens_design_RRFS/obs_data/ccpa/proc"
#MRMS_OBS_DIR="/scratch2/BMC/fv3lam/ens_design_RRFS/obs_data/mrms/proc"
#NDAS_OBS_DIR="/scratch2/BMC/fv3lam/ens_design_RRFS/obs_data/ndas/proc"
# Sample directory with artificially missing data.
CCPA_OBS_DIR="/scratch2/BMC/det/Gerard.Ketefian/UFS_CAM/DTC_ensemble_task/obs_data/ccpa/proc"
MRMS_OBS_DIR="/scratch2/BMC/det/Gerard.Ketefian/UFS_CAM/DTC_ensemble_task/obs_data/mrms/proc"
NDAS_OBS_DIR="/scratch2/BMC/det/Gerard.Ketefian/UFS_CAM/DTC_ensemble_task/obs_data/ndas/proc"

RUN_TASK_MAKE_GRID="FALSE"
RUN_TASK_MAKE_OROG="FALSE"
RUN_TASK_MAKE_SFC_CLIMO="FALSE"
RUN_TASK_GET_EXTRN_ICS="FALSE"
RUN_TASK_GET_EXTRN_LBCS="FALSE"
RUN_TASK_MAKE_ICS="FALSE"
RUN_TASK_MAKE_LBCS="FALSE"
RUN_TASK_RUN_FCST="FALSE"
RUN_TASK_RUN_POST="FALSE"

RUN_TASK_GET_OBS_CCPA="FALSE"
RUN_TASK_GET_OBS_MRMS="FALSE"
RUN_TASK_GET_OBS_NDAS="FALSE"

RUN_TASKS_VXDET="TRUE"
RUN_TASKS_VXENS="TRUE"
RUN_GEN_ENS_PROD="TRUE"
RUN_ENSEMBLE_STAT="TRUE"

INCLUDE_OLD_VX_TASKS_IN_XML="FALSE"
RUN_TASK_VX_GRIDSTAT="TRUE"
RUN_TASK_VX_POINTSTAT="TRUE"
RUN_TASK_VX_ENSGRID="TRUE"
RUN_TASK_VX_ENSPOINT="TRUE"

#VX_FIELDS_GRIDDED=( "APCP" "REFC" )
#VX_FIELDS_POINT=( "UPA" )
#VX_APCP_ACCUMS_HRS=( "03" "06" "24" )
#VX_APCP_ACCUMS_HRS=()

#FCST_FN_TEMPLATE='${NET}.t{init?fmt=%H?shift=-${TIME_LAG}}z.bgdawpf{lead?fmt=%HHH?shift=${TIME_LAG}}.tm00.grib2'
#FCST_FN_METPROC_TEMPLATE='${NET}.t{init?fmt=%H}z.bgdawpf{lead?fmt=%HHH}.tm00_a{level?fmt=%HH}h.nc'

FCST_SUBDIR_TEMPLATE='{init?fmt=%Y%m%d%H?shift=-${time_lag}}${SLASH_ENSMEM_SUBDIR_OR_NULL}/postprd'
FCST_FN_TEMPLATE='${NET}.t{init?fmt=%H?shift=-${time_lag}}z.bgdawpf{lead?fmt=%HHH?shift=${time_lag}}.tm00.grib2'
FCST_SUBDIR_METPROC_TEMPLATE='{init?fmt=%Y%m%d%H}${SLASH_ENSMEM_SUBDIR_OR_NULL}/metprd/pcp_combine_fcst_cmn'
FCST_FN_METPROC_TEMPLATE='${NET}.t{init?fmt=%H}z.bgdawpf{lead?fmt=%HHH}.tm00_a${ACCUM}h.nc'

